<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
<meta charset="UTF-8">
<title>Insert title here</title>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-KK94CHFLLe+nY2dmCWGMq91rCGa5gtU4mk92HdvYe+M/SXH301p5ILy+dN9+nJOZ" crossorigin="anonymous">
</head>
<body>

	<header th:insert="~{navbar/header::nav}"></header>
	
	<div class="container">
	
	<h3>Article : <span th:text="${article.titre}"></span> </h3>
	
	
	<ul class="list-group list-group-flush">
	  <li class="list-group-item">Résumé: <span th:text="${article.resume}"></span>  </li>
	  <li class="list-group-item"> Contenu: <span th:text="${article.contenu}"></span>  </li>
	  <li class="list-group-item"> Auteur: <span th:text="${article.user.prenom}"></span>  </li>
	</ul>
	
	<div class="alert alert-success" th:if="${session.update != null}" th:text="${session.update}"></div>
	
	<div sec:authorize="isAuthenticated()">
	   <div th:if="${#authentication.principal.username} == ${article.user.email} or ${#strings.contains(#authentication.principal.authorities, 'ADMIN')}" >
		
		<form method="post" th:object="${article}" th:action="@{/showArticle/}+${article.id}">
		  <div class="mb-3">
		    <label for="exampleInputEmail1" class="form-label">Saisir titre</label>
		    <input type="text" class="form-control" id="nom" th:field="*{titre}"/>
		    <!-- Message d'erreur -->
		    	<div class="alert alert-danger"  th:if="${#fields.hasErrors('titre')}" th:errors="*{titre}"></div>
		  </div>
		  <div class="mb-3">
		    <label for="exampleInputEmail1" class="form-label">Saisir résumé</label>
		    <input type="text" class="form-control" id="nom" th:field="*{resume}"/>
		   
		    	<div class="alert alert-danger"  th:if="${#fields.hasErrors('resume')}" th:errors="*{resume}"></div>
		  </div>
		  <div class="mb-3">
		    <label for="exampleInputEmail1" class="form-label">Saisir contenu</label>
		    <input type="text" class="form-control" id="nom" th:field="*{contenu}"/>
		    
		    	<div class="alert alert-danger" th:if="${#fields.hasErrors('contenu')}" th:errors="*{contenu}"></div>
		    
		  </div>
	 	 <button type="submit" class="btn btn-outline-warning">Modifier mon article</button>
		</form>
	 
		
		<a th:href="@{/delete}">
			<button type="button"  class="btn btn-outline-danger" >Danger</button>	
		</a>
	  </div>
		
	</div>
	
	<hr>
	   	<h5>Liste des commentaires</h5>
	   	<div th:each="comment:${comments}">
	   	<p> Posté par: <span th:text="${comment.user.prenom}"></span> </p>
	   	<p th:text="${comment.content}">
	   	</p>
   	<hr>
   	</div>
   	
   	<!-- Check si on supprime l'article -->
     <div sec:authorize="isAuthenticated()">
   	
		   	<form method="post" th:action="@{/showArticle/}+${article.id}" th:object="${comment}" >
		   	
		   	<input type="hidden" name="article" th:value="${article.id}" />
			  <div class="form-floating">
			  <textarea class="form-control" name="content" placeholder="Leave a comment here" id="floatingTextarea"></textarea>
			  <label for="floatingTextarea">Comments</label>
			</div>
		  <button type="submit" class="btn btn-primary">Je commente</button>
		</form>
     </div>
</body>
</html>